import{d as U,ar as ue,aE as Ie,ao as ee,Y as pe,a5 as Q,aw as H,V as Ve,P as ae,aF as ze,u as f,o as u,c as N,a as D,F as R,D as Y,H as j,b as e,ad as me,Q as xe,a1 as Oe,aG as Te,aH as Le,$ as $e,G as W,a6 as re,h as o,t as _,y as M,aI as Pe,ah as Fe,aJ as Re,r as O,f as te,K as Ue,w as t,x as Ae,m as T,q as Be,al as We,aa as Me,az as ce,aK as le,E as qe,n as He,p as Ke,v as je,_ as Ge}from"./index-40611390.js";import{v as Je}from"./el-loading-a5a97b93.js";import{E as Qe,a as Ye,b as Xe}from"./el-table-column-7d5a23c4.js";import{a as Ze,b as et,E as tt}from"./el-select-9508f823.js";import{E as lt,a as at}from"./el-col-2b24903c.js";import{g as st,d as nt,r as it}from"./iot-105b226f.js";import{E as ot}from"./index-75d240aa.js";import"./strings-eb1a87b1.js";const se=Symbol("elDescriptions");var K=U({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:ue(se,{})}},render(){var P;const i=Ie(this.cell),p=(((P=this.cell)==null?void 0:P.dirs)||[]).map(E=>{const{dir:g,arg:b,modifiers:A,value:V}=E;return[g,V,b,A]}),{border:z,direction:C}=this.descriptions,h=C==="vertical",F=()=>{var E,g,b;return((b=(g=(E=this.cell)==null?void 0:E.children)==null?void 0:g.label)==null?void 0:b.call(g))||i.label},c=()=>{var E,g,b;return(b=(g=(E=this.cell)==null?void 0:E.children)==null?void 0:g.default)==null?void 0:b.call(g)},s=i.span,y=i.rowspan,m=i.align?`is-${i.align}`:"",r=i.labelAlign?`is-${i.labelAlign}`:m,w=i.className,d=i.labelClassName,k=this.type==="label"&&(i.labelWidth||this.descriptions.labelWidth)||i.width,S={width:ee(k),minWidth:ee(i.minWidth)},v=pe("descriptions");switch(this.type){case"label":return Q(H(this.tag,{style:S,class:[v.e("cell"),v.e("label"),v.is("bordered-label",z),v.is("vertical-label",h),r,d],colSpan:h?s:1,rowspan:h?1:y},F()),p);case"content":return Q(H(this.tag,{style:S,class:[v.e("cell"),v.e("content"),v.is("bordered-content",z),v.is("vertical-content",h),m,w],colSpan:h?s:s*2-1,rowspan:h?y*2-1:y},c()),p);default:{const E=F(),g={},b=ee(i.labelWidth||this.descriptions.labelWidth);return b&&(g.width=b,g.display="inline-block"),Q(H("td",{style:S,class:[v.e("cell"),m],colSpan:s,rowspan:y},[Ve(E)?void 0:H("span",{style:g,class:[v.e("label"),d]},E),H("span",{class:[v.e("content"),w]},c())]),p)}}}});const rt=ae({row:{type:ze(Array),default:()=>[]}}),ct=U({name:"ElDescriptionsRow"}),dt=U({...ct,props:rt,setup(P){const i=ue(se,{});return(p,z)=>f(i).direction==="vertical"?(u(),N(R,{key:0},[D("tr",null,[(u(!0),N(R,null,Y(p.row,(C,h)=>(u(),j(f(K),{key:`tr1-${h}`,cell:C,tag:"th",type:"label"},null,8,["cell"]))),128))]),D("tr",null,[(u(!0),N(R,null,Y(p.row,(C,h)=>(u(),j(f(K),{key:`tr2-${h}`,cell:C,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(u(),N("tr",{key:1},[(u(!0),N(R,null,Y(p.row,(C,h)=>(u(),N(R,{key:`tr3-${h}`},[f(i).border?(u(),N(R,{key:0},[e(f(K),{cell:C,tag:"td",type:"label"},null,8,["cell"]),e(f(K),{cell:C,tag:"td",type:"content"},null,8,["cell"])],64)):(u(),j(f(K),{key:1,cell:C,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var ut=me(dt,[["__file","descriptions-row.vue"]]);const pt=ae({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:xe,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),ve="ElDescriptionsItem",mt=U({name:"ElDescriptions"}),vt=U({...mt,props:pt,setup(P){const i=P,p=pe("descriptions"),z=Oe(),C=Te();Le(se,i);const h=$e(()=>[p.b(),p.m(z.value)]),F=(s,y,m,r=!1)=>(s.props||(s.props={}),y>m&&(s.props.span=m),r&&(s.props.span=y),s),c=()=>{if(!C.default)return[];const s=Pe(C.default()).filter(k=>{var S;return((S=k==null?void 0:k.type)==null?void 0:S.name)===ve}),y=[];let m=[],r=i.column,w=0;const d=[];return s.forEach((k,S)=>{var v,E,g;const b=((v=k.props)==null?void 0:v.span)||1,A=((E=k.props)==null?void 0:E.rowspan)||1,V=y.length;if(d[V]||(d[V]=0),A>1)for(let L=1;L<A;L++)d[g=V+L]||(d[g]=0),d[V+L]++,w++;if(d[V]>0&&(r-=d[V],d[V]=0),S<s.length-1&&(w+=b>r?r:b),S===s.length-1){const L=i.column-w%i.column;m.push(F(k,L,r,!0)),y.push(m);return}b<r?(r-=b,m.push(k)):(m.push(F(k,b,r)),y.push(m),r=i.column,m=[])}),y};return(s,y)=>(u(),N("div",{class:W(f(h))},[s.title||s.extra||s.$slots.title||s.$slots.extra?(u(),N("div",{key:0,class:W(f(p).e("header"))},[D("div",{class:W(f(p).e("title"))},[re(s.$slots,"title",{},()=>[o(_(s.title),1)])],2),D("div",{class:W(f(p).e("extra"))},[re(s.$slots,"extra",{},()=>[o(_(s.extra),1)])],2)],2)):M("v-if",!0),D("div",{class:W(f(p).e("body"))},[D("table",{class:W([f(p).e("table"),f(p).is("bordered",s.border)])},[D("tbody",null,[(u(!0),N(R,null,Y(c(),(m,r)=>(u(),j(ut,{key:r,row:m},null,8,["row"]))),128))])],2)],2)],2))}});var _t=me(vt,[["__file","description.vue"]]);const de=["left","center","right"],ft=ae({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,values:de,default:"left"},labelAlign:{type:String,values:de},className:{type:String,default:""},labelClassName:{type:String,default:""}}),_e=U({name:ve,props:ft}),gt=Fe(_t,{DescriptionsItem:_e}),bt=Re(_e);const ht={class:"iot-device-management"},yt={class:"page-header"},Dt={class:"header-actions"},Ct={class:"search-section"},wt={class:"table-section"},St={class:"device-data"},Nt={key:0},Et={key:1},kt={key:2},It={key:3},Vt={class:"pagination-container"},zt={class:"dialog-footer"},xt={key:0,class:"device-detail"},Ot=U({__name:"index",setup(P){const i=Ae(),p=O(!1),z=O(!1),C=O(!1),h=O([]),F=O([]),c=O(null),s=O(!1),y=O(!1),m=O(),r=te({deviceId:"",deviceName:"",deviceStatus:""}),w=te({currentPage:1,pageSize:20,total:0}),d=te({deviceId:"",deviceName:"",deviceLocation:""}),k={deviceId:[{required:!0,message:"Please enter device ID",trigger:"blur"},{min:3,max:50,message:"Device ID length should be between 3-50 characters",trigger:"blur"}],deviceName:[{required:!0,message:"Please enter device name",trigger:"blur"},{min:2,max:100,message:"Device name length should be between 2-100 characters",trigger:"blur"}],deviceLocation:[{max:200,message:"Device location length cannot exceed 200 characters",trigger:"blur"}]},S=async()=>{try{p.value=!0;const n=await st();h.value=n.data.rows||[],w.total=n.data.total||0}catch(n){console.error("Failed to load device list:",n),T.error("Failed to load device list")}finally{p.value=!1}},v=()=>{w.currentPage=1,S()},E=()=>{r.deviceId="",r.deviceName="",r.deviceStatus="",v()},g=n=>{F.value=n},b=n=>{w.pageSize=n,S()},A=n=>{w.currentPage=n,S()},V=()=>{s.value=!0},L=()=>{var n;d.deviceId="",d.deviceName="",d.deviceLocation="",(n=m.value)==null||n.resetFields()},fe=async()=>{m.value&&await m.value.validate(async n=>{if(n)try{C.value=!0;const l=await it(d);l.success?(T.success("Device registered successfully"),s.value=!1,S()):T.error(l.msg||"Device registration failed")}catch(l){T.error(l.message||"Device registration failed")}finally{C.value=!1}})},ge=n=>{c.value=n,y.value=!0},be=n=>{i.push({path:"/iot-dashboard",query:{deviceId:n.device_id}})},he=async n=>{try{await ot.confirm(`Are you sure you want to delete device "${n.device_name}"?`,"Confirm Delete",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",type:"warning"}),T.success("Delete function to be implemented")}catch{T.info("Delete operation cancelled")}},ye=async()=>{try{z.value=!0;const n=await nt(10);n.success?(T.success(n.msg||"Offline device check completed"),S()):T.error(n.msg||"Check failed")}catch(n){T.error(n.message||"Failed to check offline devices")}finally{z.value=!1}},G=n=>new Date(n).toLocaleString();return Ue(()=>{S()}),(n,l)=>{const B=qe,x=Be,q=He,J=at,X=Ze,De=et,Ce=lt,$=Xe,ne=tt,we=Qe,Se=Ye,Z=Ke,Ne=je,ie=We,I=bt,Ee=gt,ke=Je;return u(),N("div",ht,[D("div",yt,[l[13]||(l[13]=D("div",{class:"header-title"},[D("h2",null,"Device Management"),D("p",null,"Manage IoT device registration, status and configuration")],-1)),D("div",Dt,[e(x,{type:"primary",onClick:V},{default:t(()=>[e(B,null,{default:t(()=>[e(f(Me))]),_:1}),l[11]||(l[11]=o(" Register Device "))]),_:1,__:[11]}),e(x,{onClick:ye,loading:z.value},{default:t(()=>[e(B,null,{default:t(()=>[e(f(ce))]),_:1}),l[12]||(l[12]=o(" Check Offline Devices "))]),_:1,__:[12]},8,["loading"])])]),D("div",Ct,[e(Ce,{gutter:20},{default:t(()=>[e(J,{span:6},{default:t(()=>[e(q,{modelValue:r.deviceId,"onUpdate:modelValue":l[0]||(l[0]=a=>r.deviceId=a),placeholder:"Device ID",clearable:"",onInput:v},{prefix:t(()=>[e(B,null,{default:t(()=>[e(f(le))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(J,{span:6},{default:t(()=>[e(q,{modelValue:r.deviceName,"onUpdate:modelValue":l[1]||(l[1]=a=>r.deviceName=a),placeholder:"Device Name",clearable:"",onInput:v},{prefix:t(()=>[e(B,null,{default:t(()=>[e(f(le))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(J,{span:6},{default:t(()=>[e(De,{modelValue:r.deviceStatus,"onUpdate:modelValue":l[2]||(l[2]=a=>r.deviceStatus=a),placeholder:"Device Status",clearable:"",onChange:v},{default:t(()=>[e(X,{label:"All",value:""}),e(X,{label:"Online",value:"online"}),e(X,{label:"Offline",value:"offline"})]),_:1},8,["modelValue"])]),_:1}),e(J,{span:6},{default:t(()=>[e(x,{type:"primary",onClick:v},{default:t(()=>[e(B,null,{default:t(()=>[e(f(le))]),_:1}),l[14]||(l[14]=o(" Search "))]),_:1,__:[14]}),e(x,{onClick:E},{default:t(()=>[e(B,null,{default:t(()=>[e(f(ce))]),_:1}),l[15]||(l[15]=o(" Reset "))]),_:1,__:[15]})]),_:1})]),_:1})]),D("div",wt,[Q((u(),j(we,{data:h.value,style:{width:"100%"},stripe:"",onSelectionChange:g},{default:t(()=>[e($,{type:"selection",width:"55"}),e($,{prop:"device_id",label:"Device ID",width:"180"}),e($,{prop:"device_name",label:"Device Name",width:"200"}),e($,{prop:"device_location",label:"Device Location",width:"200"}),e($,{label:"Device Status",width:"100"},{default:t(({row:a})=>[e(ne,{type:a.device_status==="online"?"success":"danger",size:"small"},{default:t(()=>[o(_(a.device_status==="online"?"Online":"Offline"),1)]),_:2},1032,["type"])]),_:1}),e($,{label:"Current Data",width:"300"},{default:t(({row:a})=>[D("div",St,[a.current_co2_ppm?(u(),N("span",Nt,"CO₂: "+_(a.current_co2_ppm)+"ppm",1)):M("",!0),a.current_tvoc_ppb?(u(),N("span",Et,"TVOC: "+_(a.current_tvoc_ppb)+"ppb",1)):M("",!0),a.current_env_temperature?(u(),N("span",kt,"Temp: "+_(a.current_env_temperature)+"℃",1)):M("",!0),a.current_env_humidity?(u(),N("span",It,"Humidity: "+_(a.current_env_humidity)+"%",1)):M("",!0)])]),_:1}),e($,{prop:"last_update_time",label:"Last Update Time",width:"180"},{default:t(({row:a})=>[o(_(a.last_update_time?G(a.last_update_time):"--"),1)]),_:1}),e($,{label:"Actions",width:"200",fixed:"right"},{default:t(({row:a})=>[e(x,{type:"primary",size:"small",onClick:oe=>ge(a)},{default:t(()=>l[16]||(l[16]=[o(" Details ")])),_:2,__:[16]},1032,["onClick"]),e(x,{type:"success",size:"small",onClick:oe=>be(a)},{default:t(()=>l[17]||(l[17]=[o(" Data ")])),_:2,__:[17]},1032,["onClick"]),e(x,{type:"danger",size:"small",onClick:oe=>he(a)},{default:t(()=>l[18]||(l[18]=[o(" Delete ")])),_:2,__:[18]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ke,p.value]]),D("div",Vt,[e(Se,{"current-page":w.currentPage,"onUpdate:currentPage":l[3]||(l[3]=a=>w.currentPage=a),"page-size":w.pageSize,"onUpdate:pageSize":l[4]||(l[4]=a=>w.pageSize=a),"page-sizes":[10,20,50,100],total:w.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:b,onCurrentChange:A},null,8,["current-page","page-size","total"])])]),e(ie,{modelValue:s.value,"onUpdate:modelValue":l[9]||(l[9]=a=>s.value=a),title:"Register New Device",width:"500px",onClose:L},{footer:t(()=>[D("span",zt,[e(x,{onClick:l[8]||(l[8]=a=>s.value=!1)},{default:t(()=>l[19]||(l[19]=[o("Cancel")])),_:1,__:[19]}),e(x,{type:"primary",onClick:fe,loading:C.value},{default:t(()=>l[20]||(l[20]=[o(" Confirm ")])),_:1,__:[20]},8,["loading"])])]),default:t(()=>[e(Ne,{ref_key:"registerFormRef",ref:m,model:d,rules:k,"label-width":"120px"},{default:t(()=>[e(Z,{label:"Device ID",prop:"deviceId"},{default:t(()=>[e(q,{modelValue:d.deviceId,"onUpdate:modelValue":l[5]||(l[5]=a=>d.deviceId=a),placeholder:"Enter device ID"},null,8,["modelValue"])]),_:1}),e(Z,{label:"Device Name",prop:"deviceName"},{default:t(()=>[e(q,{modelValue:d.deviceName,"onUpdate:modelValue":l[6]||(l[6]=a=>d.deviceName=a),placeholder:"Enter device name"},null,8,["modelValue"])]),_:1}),e(Z,{label:"Device Location",prop:"deviceLocation"},{default:t(()=>[e(q,{modelValue:d.deviceLocation,"onUpdate:modelValue":l[7]||(l[7]=a=>d.deviceLocation=a),placeholder:"Enter device location"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(ie,{modelValue:y.value,"onUpdate:modelValue":l[10]||(l[10]=a=>y.value=a),title:"Device Details",width:"800px"},{default:t(()=>[c.value?(u(),N("div",xt,[e(Ee,{column:2,border:""},{default:t(()=>[e(I,{label:"Device ID"},{default:t(()=>[o(_(c.value.device_id),1)]),_:1}),e(I,{label:"Device Name"},{default:t(()=>[o(_(c.value.device_name),1)]),_:1}),e(I,{label:"Device Location"},{default:t(()=>[o(_(c.value.device_location),1)]),_:1}),e(I,{label:"Device Status"},{default:t(()=>[e(ne,{type:c.value.device_status==="online"?"success":"danger"},{default:t(()=>[o(_(c.value.device_status==="online"?"Online":"Offline"),1)]),_:1},8,["type"])]),_:1}),e(I,{label:"CO₂ Concentration"},{default:t(()=>[o(_(c.value.current_co2_ppm||"--")+" ppm ",1)]),_:1}),e(I,{label:"TVOC Concentration"},{default:t(()=>[o(_(c.value.current_tvoc_ppb||"--")+" ppb ",1)]),_:1}),e(I,{label:"Chip Temperature"},{default:t(()=>[o(_(c.value.current_chip_temperature||"--")+" ℃ ",1)]),_:1}),e(I,{label:"Environmental Temperature"},{default:t(()=>[o(_(c.value.current_env_temperature||"--")+" ℃ ",1)]),_:1}),e(I,{label:"Environmental Humidity"},{default:t(()=>[o(_(c.value.current_env_humidity||"--")+" % ",1)]),_:1}),e(I,{label:"Last Update Time"},{default:t(()=>[o(_(c.value.last_update_time?G(c.value.last_update_time):"--"),1)]),_:1}),e(I,{label:"Last Offline Time"},{default:t(()=>[o(_(c.value.last_offline_time?G(c.value.last_offline_time):"--"),1)]),_:1}),e(I,{label:"Creation Time"},{default:t(()=>[o(_(c.value.create_time?G(c.value.create_time):"--"),1)]),_:1})]),_:1})])):M("",!0)]),_:1},8,["modelValue"])])}}});const Bt=Ge(Ot,[["__scopeId","data-v-8960aa4a"]]);export{Bt as default};
