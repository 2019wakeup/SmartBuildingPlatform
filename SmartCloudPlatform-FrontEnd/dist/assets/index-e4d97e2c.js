import{O as me,P as Ve,Q as Ie,R as $,S as Ee,T as _e,U as ae,V as Y,W as z,d as A,X as we,Y as $e,r as U,f as re,Z as Se,$ as q,a0 as J,a1 as Te,a2 as Ue,a3 as De,K as ge,a4 as Ce,o as V,c as C,a5 as pe,u as i,G as te,i as x,a6 as ee,b as l,w as p,H,a7 as he,a8 as Pe,E as ue,y as ce,a9 as Ae,aa as ke,ab as Fe,ac as oe,n as ie,ad as ze,ae as Me,af as Be,ag as fe,ah as Le,ai as Re,aj as Oe,a as P,ak as K,q as de,h as D,_ as ne,F as qe,D as Ke,t as He,al as Ye,p as Ge,v as We,m as F}from"./index-40611390.js";import{E as je,a as Qe,b as Xe}from"./el-table-column-7d5a23c4.js";import"./el-select-9508f823.js";import{g as ve,d as Ze,u as Je,a as xe}from"./user-578891a8.js";import{E as ea}from"./index-75d240aa.js";import"./strings-eb1a87b1.js";const aa=100,ta=600,be={beforeMount(d,s){const t=s.value,{interval:e=aa,delay:v=ta}=me(t)?{}:t;let m,c;const n=()=>me(t)?t():t.handler(),b=()=>{c&&(clearTimeout(c),c=void 0),m&&(clearInterval(m),m=void 0)};d.addEventListener("mousedown",r=>{r.button===0&&(b(),n(),document.addEventListener("mouseup",()=>b(),{once:!0}),c=setTimeout(()=>{m=setInterval(()=>{n()},e)},v))})}},na=Ve({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:Ie,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:d=>d===null||$(d)||["min","max"].includes(d),default:null},name:String,placeholder:String,precision:{type:Number,validator:d=>d>=0&&d===Number.parseInt(`${d}`,10)},validateEvent:{type:Boolean,default:!0},...Ee(["ariaLabel"])}),la={[_e]:(d,s)=>s!==d,blur:d=>d instanceof FocusEvent,focus:d=>d instanceof FocusEvent,[ae]:d=>$(d)||Y(d),[z]:d=>$(d)||Y(d)},sa=A({name:"ElInputNumber"}),oa=A({...sa,props:na,emits:la,setup(d,{expose:s,emit:t}){const e=d,{t:v}=we(),m=$e("input-number"),c=U(),n=re({currentValue:e.modelValue,userInput:null}),{formItem:b}=Se(),r=q(()=>$(e.modelValue)&&e.modelValue<=e.min),I=q(()=>$(e.modelValue)&&e.modelValue>=e.max),M=q(()=>{const a=W(e.step);return J(e.precision)?Math.max(W(e.modelValue),a):(a>e.precision,e.precision)}),N=q(()=>e.controls&&e.controlsPosition==="right"),G=Te(),h=Ue(),B=q(()=>{if(n.userInput!==null)return n.userInput;let a=n.currentValue;if(Y(a))return"";if($(a)){if(Number.isNaN(a))return"";J(e.precision)||(a=a.toFixed(e.precision))}return a}),L=(a,o)=>{if(J(o)&&(o=M.value),o===0)return Math.round(a);let u=String(a);const _=u.indexOf(".");if(_===-1||!u.replace(".","").split("")[_+o])return a;const X=u.length;return u.charAt(X-1)==="5"&&(u=`${u.slice(0,Math.max(0,X-1))}6`),Number.parseFloat(Number(u).toFixed(o))},W=a=>{if(Y(a))return 0;const o=a.toString(),u=o.indexOf(".");let _=0;return u!==-1&&(_=o.length-u-1),_},j=(a,o=1)=>$(a)?L(a+e.step*o):n.currentValue,R=()=>{if(e.readonly||h.value||I.value)return;const a=Number(B.value)||0,o=j(a);f(o),t(ae,n.currentValue),se()},k=()=>{if(e.readonly||h.value||r.value)return;const a=Number(B.value)||0,o=j(a,-1);f(o),t(ae,n.currentValue),se()},Q=(a,o)=>{const{max:u,min:_,step:g,precision:w,stepStrictly:X,valueOnClear:Z}=e;u<_&&Me("InputNumber","min should not be greater than max.");let y=Number(a);if(Y(a)||Number.isNaN(y))return null;if(a===""){if(Z===null)return null;y=Be(Z)?{min:_,max:u}[Z]:Z}return X&&(y=L(Math.round(y/g)*g,w),y!==a&&o&&t(z,y)),J(w)||(y=L(y,w)),(y>u||y<_)&&(y=y>u?u:_,o&&t(z,y)),y},f=(a,o=!0)=>{var u;const _=n.currentValue,g=Q(a);if(!o){t(z,g);return}_===g&&a||(n.userInput=null,t(z,g),_!==g&&t(_e,g,_),e.validateEvent&&((u=b==null?void 0:b.validate)==null||u.call(b,"change").catch(w=>fe())),n.currentValue=g)},E=a=>{n.userInput=a;const o=a===""?null:Number(a);t(ae,o),f(o,!1)},S=a=>{const o=a!==""?Number(a):"";($(o)&&!Number.isNaN(o)||a==="")&&f(o),se(),n.userInput=null},O=()=>{var a,o;(o=(a=c.value)==null?void 0:a.focus)==null||o.call(a)},T=()=>{var a,o;(o=(a=c.value)==null?void 0:a.blur)==null||o.call(a)},le=a=>{t("focus",a)},Ne=a=>{var o,u;n.userInput=null,n.currentValue===null&&((o=c.value)!=null&&o.input)&&(c.value.input.value=""),t("blur",a),e.validateEvent&&((u=b==null?void 0:b.validate)==null||u.call(b,"blur").catch(_=>fe()))},se=()=>{n.currentValue!==e.modelValue&&(n.currentValue=e.modelValue)},ye=a=>{document.activeElement===a.target&&a.preventDefault()};return De(()=>e.modelValue,(a,o)=>{const u=Q(a,!0);n.userInput===null&&u!==o&&(n.currentValue=u)},{immediate:!0}),ge(()=>{var a;const{min:o,max:u,modelValue:_}=e,g=(a=c.value)==null?void 0:a.input;if(g.setAttribute("role","spinbutton"),Number.isFinite(u)?g.setAttribute("aria-valuemax",String(u)):g.removeAttribute("aria-valuemax"),Number.isFinite(o)?g.setAttribute("aria-valuemin",String(o)):g.removeAttribute("aria-valuemin"),g.setAttribute("aria-valuenow",n.currentValue||n.currentValue===0?String(n.currentValue):""),g.setAttribute("aria-disabled",String(h.value)),!$(_)&&_!=null){let w=Number(_);Number.isNaN(w)&&(w=null),t(z,w)}g.addEventListener("wheel",ye,{passive:!1})}),Ce(()=>{var a,o;const u=(a=c.value)==null?void 0:a.input;u==null||u.setAttribute("aria-valuenow",`${(o=n.currentValue)!=null?o:""}`)}),s({focus:O,blur:T}),(a,o)=>(V(),C("div",{class:te([i(m).b(),i(m).m(i(G)),i(m).is("disabled",i(h)),i(m).is("without-controls",!a.controls),i(m).is("controls-right",i(N))]),onDragstart:oe(()=>{},["prevent"])},[a.controls?pe((V(),C("span",{key:0,role:"button","aria-label":i(v)("el.inputNumber.decrease"),class:te([i(m).e("decrease"),i(m).is("disabled",i(r))]),onKeydown:x(k,["enter"])},[ee(a.$slots,"decrease-icon",{},()=>[l(i(ue),null,{default:p(()=>[i(N)?(V(),H(i(he),{key:0})):(V(),H(i(Pe),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[i(be),k]]):ce("v-if",!0),a.controls?pe((V(),C("span",{key:1,role:"button","aria-label":i(v)("el.inputNumber.increase"),class:te([i(m).e("increase"),i(m).is("disabled",i(I))]),onKeydown:x(R,["enter"])},[ee(a.$slots,"increase-icon",{},()=>[l(i(ue),null,{default:p(()=>[i(N)?(V(),H(i(Ae),{key:0})):(V(),H(i(ke),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[i(be),R]]):ce("v-if",!0),l(i(ie),{id:a.id,ref_key:"input",ref:c,type:"number",step:a.step,"model-value":i(B),placeholder:a.placeholder,readonly:a.readonly,disabled:i(h),size:i(G),max:a.max,min:a.min,name:a.name,"aria-label":a.ariaLabel,"validate-event":!1,onKeydown:[x(oe(R,["prevent"]),["up"]),x(oe(k,["prevent"]),["down"])],onBlur:Ne,onFocus:le,onInput:E,onChange:S},Fe({_:2},[a.$slots.prefix?{name:"prefix",fn:p(()=>[ee(a.$slots,"prefix")])}:void 0,a.$slots.suffix?{name:"suffix",fn:p(()=>[ee(a.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","onKeydown"])],42,["onDragstart"]))}});var ra=ze(oa,[["__file","input-number.vue"]]);const ua=Le(ra),ia={class:"user-header"},da={class:"info"},ma={class:"buttons"},pa=A({__name:"UserHeader",props:Re({currentUser:{},selectedUser:{}},{currentUser:{},currentUserModifiers:{}}),emits:["update:currentUser"],setup(d){const s=Oe(d,"currentUser");return(t,e)=>{const v=ie,m=K("Plus"),c=ue,n=de,b=K("Edit"),r=K("Delete"),I=K("Search"),M=K("Tools");return V(),C("div",ia,[P("div",da,[e[8]||(e[8]=P("span",null,"NO.",-1)),l(v,{modelValue:s.value.no,"onUpdate:modelValue":e[0]||(e[0]=N=>s.value.no=N),class:"input",readonly:""},null,8,["modelValue"]),e[9]||(e[9]=P("span",null,"ID",-1)),l(v,{modelValue:s.value.id,"onUpdate:modelValue":e[1]||(e[1]=N=>s.value.id=N),class:"input",readonly:""},null,8,["modelValue"]),e[10]||(e[10]=P("span",null,"Name",-1)),l(v,{modelValue:s.value.name,"onUpdate:modelValue":e[2]||(e[2]=N=>s.value.name=N),class:"input",readonly:""},null,8,["modelValue"])]),P("div",ma,[l(n,{type:"primary",onClick:e[3]||(e[3]=N=>t.$emit("add"))},{default:p(()=>[l(c,null,{default:p(()=>[l(m)]),_:1}),e[11]||(e[11]=D("ADD"))]),_:1,__:[11]}),l(n,{type:"success",onClick:e[4]||(e[4]=N=>t.$emit("edit"))},{default:p(()=>[l(c,null,{default:p(()=>[l(b)]),_:1}),e[12]||(e[12]=D("EDIT"))]),_:1,__:[12]}),l(n,{type:"danger",onClick:e[5]||(e[5]=N=>t.$emit("delete"))},{default:p(()=>[l(c,null,{default:p(()=>[l(r)]),_:1}),e[13]||(e[13]=D("DELETE"))]),_:1,__:[13]}),l(n,{type:"info",onClick:e[6]||(e[6]=N=>t.$emit("search"))},{default:p(()=>[l(c,null,{default:p(()=>[l(I)]),_:1}),e[14]||(e[14]=D("SEARCH"))]),_:1,__:[14]}),l(n,{type:"warning",onClick:e[7]||(e[7]=N=>t.$emit("test-api"))},{default:p(()=>[l(c,null,{default:p(()=>[l(M)]),_:1}),e[15]||(e[15]=D("Test API"))]),_:1,__:[15]})])])}}});const ca=ne(pa,[["__scopeId","data-v-92318cd3"]]),fa={class:"tabs"},va=["onClick"],ba=A({__name:"UserTabs",props:{modelValue:{}},emits:["update:activeTab"],setup(d){return(s,t)=>(V(),C("div",fa,[(V(),C(qe,null,Ke(["STUDENT","TEACHER","STAFF"],e=>P("div",{key:e,class:te(["tab",{active:s.modelValue===e}]),onClick:v=>s.$emit("update:activeTab",e)},He(e),11,va)),64))]))}});const _a=ne(ba,[["__scopeId","data-v-2ae6412c"]]),ga={class:"table"},Na={class:"pagination"},ya=A({__name:"UserTable",props:{userList:{},total:{},loading:{type:Boolean},selectedUser:{},queryParams:{}},emits:["row-click","size-change","current-change","more"],setup(d){return(s,t)=>{const e=Xe,v=de,m=je,c=Qe;return V(),C("div",ga,[l(m,{data:s.userList,style:{width:"100%"},height:"500",onRowClick:t[0]||(t[0]=n=>s.$emit("row-click",n))},{default:p(()=>[l(e,{prop:"no",label:"NO.",width:"80",align:"center"}),l(e,{prop:"userId",label:"ID",width:"150",align:"center"}),l(e,{prop:"userName",label:"Name",width:"120",align:"center"}),l(e,{prop:"account",label:"Account",width:"120",align:"center"}),l(e,{prop:"email",label:"Email",width:"180",align:"center"}),l(e,{prop:"phone",label:"Phone",width:"120",align:"center"}),l(e,{prop:"roleId",label:"Role ID",width:"80",align:"center"}),l(e,{label:"More",align:"center"},{default:p(n=>[l(v,{type:"primary",text:"",onClick:b=>s.$emit("more",n.row)},{default:p(()=>t[5]||(t[5]=[D("More")])),_:2,__:[5]},1032,["onClick"])]),_:1})]),_:1},8,["data"]),P("div",Na,[l(c,{"current-page":s.queryParams.pageNum,"onUpdate:currentPage":t[1]||(t[1]=n=>s.queryParams.pageNum=n),"page-size":s.queryParams.pageSize,"onUpdate:pageSize":t[2]||(t[2]=n=>s.queryParams.pageSize=n),total:s.total,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:t[3]||(t[3]=n=>s.$emit("size-change",n)),onCurrentChange:t[4]||(t[4]=n=>s.$emit("current-change",n))},null,8,["current-page","page-size","total"])])])}}});const Va=ne(ya,[["__scopeId","data-v-5ed0b7c2"]]);const Ia=A({__name:"UserDialog",props:{visible:{type:Boolean},formData:{},isEdit:{type:Boolean}},emits:["submit","reset"],setup(d){return(s,t)=>{const e=ie,v=Ge,m=ua,c=We,n=de,b=Ye;return V(),H(b,{"model-value":s.visible,title:s.isEdit?"修改用户":"添加用户",onClose:t[7]||(t[7]=r=>s.$emit("reset")),width:"600px"},{footer:p(()=>[l(n,{onClick:t[5]||(t[5]=r=>s.$emit("reset"))},{default:p(()=>t[8]||(t[8]=[D("取消")])),_:1,__:[8]}),l(n,{type:"primary",onClick:t[6]||(t[6]=r=>s.$emit("submit"))},{default:p(()=>t[9]||(t[9]=[D("确定")])),_:1,__:[9]})]),default:p(()=>[l(c,{model:s.formData,ref:"formRef","label-width":"100px"},{default:p(()=>[l(v,{label:"用户名"},{default:p(()=>[l(e,{modelValue:s.formData.userName,"onUpdate:modelValue":t[0]||(t[0]=r=>s.formData.userName=r)},null,8,["modelValue"])]),_:1}),l(v,{label:"账号"},{default:p(()=>[l(e,{modelValue:s.formData.account,"onUpdate:modelValue":t[1]||(t[1]=r=>s.formData.account=r)},null,8,["modelValue"])]),_:1}),l(v,{label:"邮箱"},{default:p(()=>[l(e,{modelValue:s.formData.email,"onUpdate:modelValue":t[2]||(t[2]=r=>s.formData.email=r)},null,8,["modelValue"])]),_:1}),l(v,{label:"手机号"},{default:p(()=>[l(e,{modelValue:s.formData.phone,"onUpdate:modelValue":t[3]||(t[3]=r=>s.formData.phone=r)},null,8,["modelValue"])]),_:1}),l(v,{label:"角色ID"},{default:p(()=>[l(m,{modelValue:s.formData.roleId,"onUpdate:modelValue":t[4]||(t[4]=r=>s.formData.roleId=r),min:1,max:10},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}}),Ea={class:"user-management"},wa=A({__name:"index",setup(d){const s=U([]),t=U(0),e=U(!1),v=U(!1),m=U(null),c=U("STUDENT"),n=re({no:"001",id:"202231123002001",name:"One"}),b=re({pageNum:1,pageSize:10,userName:"",account:""}),r=U({userId:void 0,userName:"",account:"",password:"123456",email:"",phone:"",roleId:2}),I=async()=>{var f,E,S;e.value=!0;try{const O=await ve(b);s.value=((E=(f=O.data)==null?void 0:f.rows)==null?void 0:E.map((T,le)=>({no:String(le+1).padStart(3,"0"),userId:T.user_id,userName:T.user_name,account:T.account,email:T.email,phone:T.phone,roleId:T.role_id})))||[],t.value=((S=O.data)==null?void 0:S.total)||0}catch{F.error("加载失败")}finally{e.value=!1}},M=f=>{m.value=f,n.no=f.no,n.id=f.userId,n.name=f.userName},N=()=>{k(),v.value=!0},G=()=>{if(!m.value)return F.warning("请先选择用户");r.value={...m.value,password:"123456"},v.value=!0},h=async()=>{m.value&&(await ea.confirm("确定要删除该用户吗？","提示"),await Ze([m.value.userId]),F.success("删除成功"),I())},B=()=>{b.pageNum=1,I()},L=f=>{F.info(`查看用户 ${f.userName} 的更多信息`)},W=f=>{b.pageSize=f,I()},j=f=>{b.pageNum=f,I()},R=async()=>{const f={user_id:r.value.userId,user_name:r.value.userName,account:r.value.account,password:r.value.password,email:r.value.email,phone:r.value.phone,role_id:r.value.roleId};r.value.userId?await Je(f):await xe(f),F.success(r.value.userId?"修改成功":"添加成功"),v.value=!1,I()},k=()=>{r.value={userId:void 0,userName:"",account:"",password:"123456",email:"",phone:"",roleId:2}},Q=async()=>{const f=await ve({pageNum:1,pageSize:10});console.log("用户API响应：",f),F.success("API 测试成功")};return ge(I),(f,E)=>(V(),C("div",Ea,[l(ca,{"current-user":n,"selected-user":m.value,onAdd:N,onEdit:G,onDelete:h,onSearch:B,onTestApi:Q},null,8,["current-user","selected-user"]),l(_a,{activeTab:c.value,"onUpdate:activeTab":E[0]||(E[0]=S=>c.value=S)},null,8,["activeTab"]),l(Va,{"user-list":s.value,"query-params":b,total:t.value,loading:e.value,"selected-user":m.value,onRowClick:M,onSizeChange:W,onCurrentChange:j,onMore:L},null,8,["user-list","query-params","total","loading","selected-user"]),l(Ia,{visible:v.value,"onUpdate:visible":E[1]||(E[1]=S=>v.value=S),"form-data":r.value,"is-edit":!!r.value.userId,onSubmit:R,onReset:k},null,8,["visible","form-data","is-edit"])]))}});const ha=ne(wa,[["__scopeId","data-v-fdff2a5c"]]);export{ha as default};
