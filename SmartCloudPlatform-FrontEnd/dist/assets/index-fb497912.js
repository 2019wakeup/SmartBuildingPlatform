import{d as c,o as y,H as q,w as i,b as o,h as p,n as V,p as z,q as C,v as I,c as w,a5 as P,a as B,F as U,r as f,al as R,f as A,K as L,m as k,_ as M}from"./index-40611390.js";import{v as j}from"./el-loading-a5a97b93.js";import{E as H,a as K,b as O}from"./el-table-column-7d5a23c4.js";import"./el-select-9508f823.js";import{E as Q}from"./index-75d240aa.js";import"./strings-eb1a87b1.js";const G=c({__name:"SearchForm",props:{query:{}},emits:["search","reset"],setup($){return(s,e)=>{const t=V,l=z,n=C,a=I;return y(),q(a,{model:s.query,inline:!0},{default:i(()=>[o(l,{label:"权限代码"},{default:i(()=>[o(t,{modelValue:s.query.code,"onUpdate:modelValue":e[0]||(e[0]=r=>s.query.code=r),placeholder:"请输入权限代码",style:{width:"200px"}},null,8,["modelValue"])]),_:1}),o(l,null,{default:i(()=>[o(n,{type:"primary",onClick:e[1]||(e[1]=r=>s.$emit("search"))},{default:i(()=>e[3]||(e[3]=[p("搜索")])),_:1,__:[3]}),o(n,{onClick:e[2]||(e[2]=r=>s.$emit("reset"))},{default:i(()=>e[4]||(e[4]=[p("重置")])),_:1,__:[4]})]),_:1})]),_:1},8,["model"])}}}),J={style:{"margin-bottom":"20px"}},W=c({__name:"ActionButtons",props:{selected:{}},emits:["add","edit","delete"],setup($){return(s,e)=>{const t=C;return y(),w("div",J,[o(t,{type:"primary",onClick:e[0]||(e[0]=l=>s.$emit("add"))},{default:i(()=>e[3]||(e[3]=[p("新增")])),_:1,__:[3]}),o(t,{type:"success",disabled:s.selected.length!==1,onClick:e[1]||(e[1]=l=>s.$emit("edit"))},{default:i(()=>e[4]||(e[4]=[p("修改")])),_:1,__:[4]},8,["disabled"]),o(t,{type:"danger",disabled:s.selected.length===0,onClick:e[2]||(e[2]=l=>s.$emit("delete"))},{default:i(()=>e[5]||(e[5]=[p("删除")])),_:1,__:[5]},8,["disabled"])])}}}),X={style:{"text-align":"center","margin-top":"20px"}},Y=c({__name:"PermissionTable",props:{data:{},total:{},loading:{type:Boolean},query:{}},emits:["selection-change","edit","delete","update:query"],setup($){const s=t=>{emit("update:query",{pageSize:t,pageNum:1})},e=t=>{emit("update:query",{pageNum:t})};return(t,l)=>{const n=O,a=C,r=H,v=K,m=j;return y(),w(U,null,[P((y(),q(r,{data:t.data,onSelectionChange:l[0]||(l[0]=d=>t.$emit("selection-change",d))},{default:i(()=>[o(n,{type:"selection",width:"55"}),o(n,{prop:"permissionId",label:"ID",width:"80"}),o(n,{prop:"code",label:"权限代码"}),o(n,{prop:"remark",label:"备注"}),o(n,{label:"操作",width:"160"},{default:i(d=>[o(a,{size:"small",onClick:b=>t.$emit("edit",d.row)},{default:i(()=>l[3]||(l[3]=[p("修改")])),_:2,__:[3]},1032,["onClick"]),o(a,{size:"small",type:"danger",onClick:b=>t.$emit("delete",d.row)},{default:i(()=>l[4]||(l[4]=[p("删除")])),_:2,__:[4]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[m,t.loading]]),B("div",X,[o(v,{"current-page":t.query.pageNum,"onUpdate:currentPage":l[1]||(l[1]=d=>t.query.pageNum=d),"page-size":t.query.pageSize,"onUpdate:pageSize":l[2]||(l[2]=d=>t.query.pageSize=d),total:t.total,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,50],onSizeChange:s,onCurrentChange:e},null,8,["current-page","page-size","total"])])],64)}}}),Z=c({__name:"PermissionDialog",props:{visible:{type:Boolean},form:{},rules:{}},emits:["update:visible","submit"],setup($,{emit:s}){const e=s,t=f(),l=()=>{t.value&&t.value.validate(n=>{n&&e("submit")})};return(n,a)=>{const r=V,v=z,m=I,d=C,b=R;return y(),q(b,{"model-value":n.visible,title:"权限配置",width:"500px",onClose:a[3]||(a[3]=g=>n.$emit("update:visible",!1))},{footer:i(()=>[o(d,{onClick:a[2]||(a[2]=g=>n.$emit("update:visible",!1))},{default:i(()=>a[4]||(a[4]=[p("取消")])),_:1,__:[4]}),o(d,{type:"primary",onClick:l},{default:i(()=>a[5]||(a[5]=[p("确定")])),_:1,__:[5]})]),default:i(()=>[o(m,{model:n.form,rules:n.rules,"label-width":"100px",ref_key:"formRef",ref:t},{default:i(()=>[o(v,{label:"权限代码",prop:"code"},{default:i(()=>[o(r,{modelValue:n.form.code,"onUpdate:modelValue":a[0]||(a[0]=g=>n.form.code=g)},null,8,["modelValue"])]),_:1}),o(v,{label:"备注"},{default:i(()=>[o(r,{type:"textarea",modelValue:n.form.remark,"onUpdate:modelValue":a[1]||(a[1]=g=>n.form.remark=g),rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value"])}}}),h={class:"permission-management"},x=c({__name:"index",setup($){const s=f([]),e=f(0),t=f(!1),l=f(!1),n=f([]),a=A({pageNum:1,pageSize:10,code:""}),r=f({permissionId:void 0,code:"",remark:""}),v={code:[{required:!0,message:"权限代码不能为空",trigger:"blur"},{max:50,message:"权限代码长度不能超过50个字符",trigger:"blur"}]};L(()=>m());const m=async()=>{t.value=!0,await new Promise(u=>setTimeout(u,500)),s.value=[{permissionId:1,code:"user:list",remark:"用户列表查看权限",createTime:"",updateTime:""},{permissionId:2,code:"user:add",remark:"用户添加权限",createTime:"",updateTime:""}],e.value=s.value.length,t.value=!1},d=u=>{Object.assign(a,u),m()},b=u=>n.value=u,g=()=>{a.pageNum=1,m()},N=()=>{a.code="",m()},T=()=>{r.value={permissionId:void 0,code:"",remark:""},l.value=!0},E=u=>{const _=u||n.value[0];if(!_)return k.warning("请选择一条记录进行编辑");r.value={..._},l.value=!0},S=async u=>{if(!(u?[u]:n.value).length)return k.warning("请选择要删除的记录");try{await Q.confirm("确定删除？","提示",{type:"warning"}),k.success("删除成功"),m()}catch{}},D=()=>{k.success(r.value.permissionId?"修改成功":"添加成功"),l.value=!1,m()};return(u,_)=>(y(),w("div",h,[_[1]||(_[1]=B("div",{class:"page-title"},"权限管理",-1)),o(G,{query:a,onSearch:g,onReset:N},null,8,["query"]),o(W,{selected:n.value,onAdd:T,onEdit:E,onDelete:S},null,8,["selected"]),o(Y,{loading:t.value,data:s.value,total:e.value,query:a,"onUpdate:query":d,onSelectionChange:b,onEdit:E,onDelete:S},null,8,["loading","data","total","query"]),o(Z,{visible:l.value,"onUpdate:visible":_[0]||(_[0]=F=>l.value=F),form:r.value,rules:v,onSubmit:D},null,8,["visible","form"])]))}});const se=M(x,[["__scopeId","data-v-3324cf0e"]]);export{se as default};
